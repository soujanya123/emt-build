var ExtremelyUglyCode=true; function $(id){ return (typeof id=="string")?document.getElementById(id):id; } var E={hide:function(id){ $(id).style.visibility="hidden"; },show:function(id){ $(id).style.visibility="visible"; },setVisible:function(id,_5){ if(_5){ E.show(id); }else{ E.hide(id); } },setOpacity:function(id,o){ if(o>0){ $(id).style.opacity=""+o; $(id).style.filter="alpha(opacity="+o*100+")"; } },getPosition:function(id){ var o=(typeof id=="string")?$(id):id; var x=0; var y=0; if(o.offsetParent){ x=o.offsetLeft; y=o.offsetTop; while(o=o.offsetParent){ x+=o.offsetLeft; y+=o.offsetTop; } } return [x,y]; },setText:function(id,_d){ $(id).innerHTML=_d; },get:function(id){ return $(id).value; },set:function(id,_10){ $(id).value=_10; },check:function(id,_12){ $(id).checked=(_12==true||_12=="true"); }}; var rcBR={W3CDOMSupported:document.getElementById&&document.createElement,PNG:!(navigator.appVersion.indexOf("MSIE")!=-1&&parseFloat(navigator.appVersion.split("MSIE")[1])<=6),ie8:navigator.appVersion.indexOf("MSIE")!=-1&&parseFloat(navigator.appVersion.split("MSIE")[1])>7,ie:navigator.appVersion.indexOf("MSIE")!=-1,op:window.opera,sf:(navigator.appVersion.indexOf("Safari")!=-1)||(navigator.appVersion.indexOf("Konqueror")!=-1)}; rcCookie={set:function(_13,_14,_15){ if(_15){ var _16=new Date(); _16.setTime(_16.getTime()+(_15*24*60*60*1000)); var _17="; expires="+_16.toGMTString(); }else{ var _17=""; } document.cookie=_13+"="+escape(_14)+_17+"; path=/"; },get:function(_18){ var _19=_18+"="; var ca=document.cookie.split(";"); for(var i=0;i<ca.length;i++){ var c=unescape(ca[i]); while(c.charAt(0)==" "){ c=c.substring(1,c.length); } if(c.indexOf(_19)==0){ return c.substring(_19.length,c.length); } } return null; },del:function(_1d){ this.set(_1d,"",-1); }}; var rcFC={socket:null,onSuccess:null,flashVersion:null,id:"rcSocket",createObject:function(_1e){ this.onSuccess=_1e; var _1f="<div id=\""+this.id+"C\" style=\""+"position: fixed; left: -1px;"+((rcBR.op)?"top: -1px;":"top:-2px;")+"\"><object id=\""+this.id+"\" type=\"application/x-shockwave-flash\""+"data=\"rcSocket.swf!110311012019\" width=\"2\" height=\"2\">"+"<param name=\"movie\" value=\"rcSocket.swf!110311012019\" />"+"</object></div>"; document.write(_1f); setTimeout("rcFC.objectCreated()",30000); },objectCreated:function(_20){ if(_20){ this.flashVersion=_20; this.socket=$(this.id); this.onSuccess(_20.substring(_20.indexOf(" ")+1,_20.indexOf(","))>=8); }else{ if(!this.flashVersion){ this.onSuccess(false); } } },connect:function(_21,_22){ this.socket.connect(_21,_22); },disconnect:function(){ this.socket.disconnect(); },send:function(){ var _23="0"; for(var i=0;i<arguments.length;i++){ _23+=arguments[i]; if(i<arguments.length-1){ _23+=rcMTP.US; } } this.socket.send(_23); },playSound:function(id){ this.socket.playSound(id); },connectionEstablished:null,connectFailed:null,connectionLost:null,receive:function(_26){ if(_26.charAt(0)=="0"){ _26=_26.substring(1); } var _27=_26.split(rcMTP.US); var _28=new Array(); if(_27.length>=2){ for(var i=2;i<_27.length;i++){ _28[i-2]=rcUtil.escapeHTML(_27[i]); } } this.messageReceived(_27[0],_27[1],_28); },messageReceived:null}; rcMTP={GS:"\x1d",RS:"\x1e",US:"\x1f"}; var rcQuery={q:location.search.substring(1,location.search.length),query:new Object(),parse:function(){ this.q=this.q.replace(/\+/g," "); var _2a=this.q.split("&"); for(var i=0;i<_2a.length;i++){ var tmp=_2a[i].split("="); var n=tmp[0]; this.query[n]=tmp[1]; } },get:function(_2e,def){ return (this.query[_2e]==null||this.query[_2e]=="undefined")?def:this.query[_2e]; }}; var rcUtil={trim:function(src){ src=src.replace(/[\u00a0\u00ad\s]+/g," "); return src.replace(/^[ \s]+|[ \s]+$/,""); },html2bb:function(src){ return rcUtil.trim(rcUtil.rgb2hexC(rcUtil.re(src,new Array({m:/&nbsp;/gi,r:" "},{m:/&amp;/gi,r:"&"},{m:/class="Apple-style-span"/gi,r:""},{m:/<br>|<br\/>/gi,r:""},{m:/<b>(.+?)<\/b>/gi,r:"[b]$1[/b]"},{m:/<i>(.+?)<\/i>/gi,r:"[i]$1[/i]"},{m:/<strong>(.+?)<\/strong>/gi,r:"[b]$1[/b]"},{m:/<em>(.+?)<\/em>/gi,r:"[i]$1[/i]"},{m:/<u>(.+?)<\/u>/gi,r:"[u]$1[/u]"},{m:/<span\s+(style="[^<>]*?)font-style:\s*italic\s*;([^<>]*?")>([^<]+?)<\/span>/gi,r:"<span $1 $2>[i]$3[/i]</span>"},{m:/<span\s+(style="[^<>]*?)font-weight:\s*bold\s*;([^<>]*?")>([^<]+?)<\/span>/gi,r:"<span $1 $2>[b]$3[/b]</span>"},{m:/<span\s+(style="[^<>]*?)text-decoration:\s*underline\s*;([^<>]*?")>([^<]+?)<\/span>/gi,r:"<span $1 $2>[u]$3[/u]</span>"},{m:/<span\s+(style="[^<>]*?)color:\s*(.+?)\s*;([^<>]*?")>(.+?)<\/span>/gi,r:"<span $1 $3>[c=$2]$4[/c]</span>"},{m:/<span\s+style="\s*">(.*?)<\/span>/gi,r:"$1"},{m:/<font\s+color="?(.+?)"?>(.+?)<\/font>/gi,r:"[c=$1]$2[/c]"},{m:/<(.|\n)+?>/gi,r:""})))); },stripHTML:function(src){ return src.replace(/<(.|\n)+?>/gi,""); },escapeHTML:function(src){ return rcUtil.re(src.replace(/&/g,"&amp;"),new Array({m:/</g,r:"&#60;"},{m:/>/g,r:"&#62;"},{m:/'/g,r:"&#39;"},{m:/"/g,r:"&#34;"})); },unescapeHTML:function(src){ return rcUtil.re(src.replace(/&amp;/g,"&"),new Array({m:/&#60;/g,r:"&lt;"},{m:/&#62;/g,r:"&gt;"},{m:/&#39;/g,r:"'"},{m:/&#34;/g,r:"\""})); },bb2html:function(src){ return rcUtil.re((src),new Array({m:/\[b\](.+?)\[\/b\]/gi,r:"<span style=\"font-weight: bold;\">$1</span>"},{m:/\[i\](.+?)\[\/i\]/gi,r:"<span style=\"font-style: italic;\">$1</span>"},{m:/\[u\](.+?)\[\/u\]/gi,r:"<span style=\"text-decoration: underline;\">$1</span>"},{m:/\[c=(#[a-f\d]{6})\](.+?)\[\/c\]/gi,r:"<span style=\"color: $1;\">$2</span>"})); },bb2plain:function(src){ return rcUtil.trim(rcUtil.re((src),new Array({m:/\[b\](.+?)\[\/b\]/gi,r:"$1"},{m:/\[i\](.+?)\[\/i\]/gi,r:"$1"},{m:/\[u\](.+?)\[\/u\]/gi,r:"$1"},{m:/\[c=(#[a-f\d]{6})\](.+?)\[\/c\]/gi,r:"$2"}))); },addLinks:function(src){ var res=""; var b=src.indexOf("http://"); if(b!=-1){ var e=src.indexOf(" ",b); var _3b=src.substring(b,e!=-1?e:src.length); res=src.substring(0,b)+"<a target=\"_blank\" href=\""+_3b.replace(/&shy;|<wbr\/>/g,"")+"\">"+_3b+"</a> "; if(e!=-1){ res+=src.substring(e); } return res; }else{ return src; } },re:function(src,re,cl){ var res=src,res1=res,c=0; do{ res=res1; for(var i=0;i<re.length;i++){ res1=res1.replace(re[i].m,re[i].r); } if(c==cl){ break; } c++; }while(res1!=res); return rcUtil.trim(res); },filter:function(_41,_42){ for(var i=0;i<_41.length;i++){ _42=_42.replace(new RegExp(_41[i],"gi"),"---"); } return _42; },wrap:function(src,mwl){ var _46=""; var lws=0; for(var i=0;i<src.length;i++){ var c=src.charAt(i); if(c==" "){ lws=i; } if(c=="h"&&src.substr(i,4)=="http"){ lws=i; } _46+=c; if((i-lws)>mwl){ _46+=(rcBR.ie||rcBR.op||rcBR.sf)?"&shy;":"<wbr/>"; lws=i; } } return _46; },rgb2hexC:function(src){ var r2h=function(_4c){ var hex="0123456789abcdef"; _4c=_4c.substring(4,_4c.indexOf(")")); var c=_4c.split(","); var res="#"; for(var i=0;i<3;i++){ res+=hex.charAt(Math.floor(c[i]/16)); res+=hex.charAt(c[i]%16); } return res; }; var res=""; var b=src.indexOf("[c=rgb("); var e=-1; while(b!=-1){ res+=src.substring(e+1,b+3); e=src.indexOf(")]",b); var rgb=src.substring(b+3,e+1); res+=r2h(rgb); b=src.indexOf("[c=rgb(",e); } res+=src.substring(e+1); return res; }}; var CCMP={SERVICE:"50",HS1:"51",HS2:"52",HS3:"53",S_HANDSHAKE_FAILED:"54",PING:"99",ERROR:"100",S_WARNING:"101",S_ERROR:"102",AUTHENTICATION:"200",C_LOGIN:"201",C_LOGOUT:"202",S_LOGIN_ACK:"203",S_LOGOUT_ACK:"204",S_AUTHENTICATION_FAILED:"205",S_ADMIN_ACCESS_DENIED:"206",S_CHECKLIST:"206",SETTINGS:"300",ACCESS_CONTROL:"301",BIND_SETTINGS:"304",PROBE_BIND_OPTIONS:"305",REGINFO:"310",REGISTRATION_OK:"312",SOFTWARE_UPDATE:"314",SERVER_ADVANCED:"315",REQUEST_RESTART:"320",VSERVER_LIST:"330",VSERVER_SELECT:"331",VSERVER_ADD:"332",VSERVER_REMOVE:"333",CHANNEL_LIST:"334",CHANNEL_SELECT:"335",CHANNEL_ADD:"336",CHANNEL_REMOVE:"337",SERVER_GENERAL:"340",SERVER_LOGGING:"341",USER_PERMISSIONS:"342",USER_BEHAVIOUR:"343",CHANNEL_GENERAL:"345",PROFILE_LIST:"346",PROFILE_SELECT:"347",PROFILE_GENERAL:"348",LANGUAGE_LIST:"349",THEME_LIST:"350",THEME_SELECT:"351",THEME_GENERAL:"352",STATISTICS:"400",SNAPSHOT:"401",HISTORY:"402",RESET:"403",B_HOME:"405",B_GROUP_LIST:"406",B_CHANNEL_LIST:"407",B_CHANNEL_DETAILS:"408",B_USER_DETAILS:"409",BAN_LIST:"420",BAN_LIFT:"421",DONE:"900",E:0}; var Logic={userName:null,password:null,loggedIn:null,restartExpected:false,applyingUpdate:false,pingTimeoutTask:null,connectTimeoutTask:null,updatesAvailable:false,host:window.location.hostname,port:window.location.port,url:window.location,init:function(){ rcFC.connectionEstablished=function(){ Logic.connectTimeoutTask=setTimeout("Logic.connectTimedOut()",5000); rcFC.send(CCMP.SERVICE,CCMP.HS1); }; rcFC.connectFailed=function(){ UI.showWarning("Error","Connection failed."); }; rcFC.connectionLost=function(){ clearTimeout(Logic.pingTimeoutTask); clearTimeout(Logic.autoUpdateTask); if(Logic.applyingUpdate){ UI.doSelect(); UI.hide("sidebar"); UI.hide("vsNavBlock"); UI.hide("roomNavBlock"); UI.hide("profileNavBlock"); UI.hide("themeNavBlock"); UI.showInfo("Update applied","Please restart your browser, or do a shift-reload to see the updated interface."); return; } if(Logic.restartExpected){ UI.showStatus("About to refresh ..."); setTimeout("window.location='"+Logic.url+"'",1000); return; } if(Logic.loggedIn){ UI.showWarning("Error","Connection lost."); UI.doSelect(); UI.hide("sidebar"); UI.hide("vsNavBlock"); UI.hide("roomNavBlock"); UI.hide("profileNavBlock"); UI.hide("themeNavBlock"); Logic.loggedIn=false; } }; rcFC.messageReceived=Logic.messageReceived; },connectTimedOut:function(){ rcFC.disconnect(); UI.showWarning("Error","Connect timed out."); },ping:function(){ clearTimeout(Logic.pingTimeoutTask); rcFC.send(CCMP.SERVICE,CCMP.PING); Logic.pingTimeoutTask=setTimeout("Logic.ping()",(Logic.autoUpdatingStats)?2000:10000); },messageReceived:function(_55,cID,_57){ if(_55==CCMP.ERROR){ if(cID==CCMP.S_WARNING){ UI.showWarning("Error",_57[0]); } } if(_55==CCMP.SERVICE){ if(cID==CCMP.HS1){ }else{ if(cID==CCMP.HS2){ rcFC.send(CCMP.SERVICE,CCMP.HS2); }else{ if(cID==CCMP.HS3){ clearTimeout(Logic.connectTimeoutTask); rcFC.send(CCMP.AUTHENTICATION,CCMP.C_LOGIN,Logic.userName,Logic.password); }else{ rcFC.connectFailed(); } } } }else{ if(_55==CCMP.AUTHENTICATION){ if(cID==CCMP.S_LOGIN_ACK){ Logic.pingTimeoutTask=setTimeout("Logic.ping()",(Logic.autoUpdatingStats)?2000:10000); UI.show("content"); UI.show("sidebar"); UI.hide("loginform"); if(Logic.updatesAvailable){ UI.doSelect("n1-4"); }else{ if(rcCookie.get("gds")){ UI.doSelect("n4-2"); $("rcGDS").checked=true; }else{ UI.goHome(); } } E.setText("productName",_57[0]+" "+_57[1]); E.setText("productLicense",_57[2]); E.setText("productLicenseKey",_57[3]); E.setText("productVersion",_57[4]+", Build: "+_57[5]+" ("+_57[6]+")"); E.setText("productEnvironment",_57[7].replace(/_n/g,"<br/>")); var _58=E.get("rcPassword"); E.set("rcAdminPassword1",_58); E.set("rcAdminPassword2",_58); Logic.loggedIn=true; UI.hideStatus(); }else{ if(cID==CCMP.S_LOGOUT_ACK){ UI.hide("sidebar"); UI.hide("vsNavBlock"); UI.hide("roomNavBlock"); UI.hide("profileNavBlock"); UI.hide("themeNavBlock"); UI.doSelect(); UI.show("loginform"); if(rcCookie.get("u")){ $("rcLoginRemember").checked=true; } Logic.loggedIn=false; }else{ if(cID==CCMP.S_AUTHENTICATION_FAILED){ UI.show("content"); UI.showWarning("Login failed","Invalid username/password combination."); }else{ if(cID==CCMP.S_ADMIN_ACCESS_DENIED){ UI.show("content"); UI.showWarning("Login failed","Administrator login not allowed for<br/>"+_57[0]); } } } } }else{ if(_55==CCMP.SETTINGS){ if(cID==CCMP.DONE){ UI.hideStatus(); }else{ if(cID==CCMP.S_CHECKLIST){ if(_57[0]=="true"){ $("cl01").className="checked"; } if(_57[1]=="true"){ $("cl02").className="checked"; } UI.show("clist"); }else{ if(cID==CCMP.ACCESS_CONTROL){ E.set("rcAdminPassword1",_57[0]); E.set("rcAdminPassword2",_57[0]); E.set("rcTrustedIPs",_57[1].replace(/[\s,\s]+/g,"\n")); }else{ if(cID==CCMP.BIND_SETTINGS){ E.setText("rcCurrentLink",_57[0]); $("rcCurrentLinkHref").href=_57[0]; if(_57[1]){ var _59="<option value='-'>no change</option>"; var tmp=_57[1].split(rcMTP.GS); for(var i=0;i<tmp.length;i++){ if(tmp[i].length>0){ _59+="<option value='"+tmp[i]+"'>"+tmp[i]+"</option>"; } } E.setText("rcBindAddressOptionsPlaceholder","<select id=\"rcBindAddressOptions\" class=\"right\">"+_59+"</select>"); } E.setText("ccCurrentLink",_57[2]); if(_57[3]){ var _59="<option value='-'>no change</option>"; var tmp=_57[3].split(rcMTP.GS); for(var i=0;i<tmp.length;i++){ if(tmp[i].length>0){ _59+="<option value='"+tmp[i]+"'>"+tmp[i]+"</option>"; } } E.setText("ccBindAddressOptionsPlaceholder","<select id=\"ccBindAddressOptions\" class=\"right\">"+_59+"</select>"); } UI.hideStatus(); }else{ if(cID==CCMP.REGISTRATION_OK){ UI.doSelect("n1-4"); UI.showInfo("Registration OK","Thank you for choosing RealChat!"); }else{ if(cID==CCMP.SOFTWARE_UPDATE){ E.setText("rcUpdateLabel",_57[0]==1?"New update available!":"None available"); E.setText("rcLastTimeChecked",_57[1]); if(_57[0]==1){ UI.show("rcHasUpdate"); UI.hide("rcUpdateControls"); Logic.updatesAvailable=true; }else{ UI.hide("rcHasUpdate"); UI.show("rcUpdateControls"); } UI.hideStatus(); }else{ if(cID==CCMP.VSERVER_LIST){ UI.hasVsBlock=true; UI.show("vsSettingsBlock"); UI.show("vsSel"); var _5c=_57[1]; if(_57[0]){ var _59=""; var _5d=_57[0].split(rcMTP.GS); for(var i=0;i<_5d.length;i++){ if(_5d[i].length>0){ var _5e=_5d[i].split(rcMTP.RS); if(_5e[0]==_57[1]){ _59+="<option selected value='"+_5e[0]+"'>"+_5e[0]+": "+_5e[1]+"</option>"; }else{ _59+="<option value='"+_5e[0]+"'>"+_5e[0]+": "+_5e[1]+"</option>"; } } } E.setText("vsNavPlaceholder","<select onchange=\"Logic.selectVS()\" id=\"vsNav\" style=\"width: 400px; vertical-align:middle;\">"+_59+"</select>"); E.setText("vsSelectPlaceholder","<select onchange=\"Logic.vsUpdateClientURL(); \" id=\"cgs\">"+_59+"</select>"); } }else{ if(cID==CCMP.SERVER_GENERAL){ E.set("vsDescription",_57[0]); E.set("vsNotes",_57[1]); E.set("vsUserLimit",_57[2]); E.set("vsRoomLimit",_57[3]); E.set("vsUsersPerRoom",_57[4]); $("vsStatus").selectedIndex=(_57[5]=="true")?1:0; UI.setVisible("vsSCT",$("vsStatus").selectedIndex); E.set("vsCloseMessage",_57[6]); E.set("vsWelcomeMessage",_57[9]); if(_57[7]==""){ $("vsUseHMAC").selectedIndex=0; E.set("vsHMAC",UI.generateHMAC()); }else{ $("vsUseHMAC").selectedIndex=1; E.set("vsHMAC",_57[7]); } UI.setVisible("vsHMT",$("vsUseHMAC").selectedIndex); $("vsDoubleLogin").selectedIndex=_57[8]; if(_57[10]!=undefined){ UI.show("brandBlock"); E.set("OEMName",_57[10]); } }else{ if(cID==CCMP.SERVER_ADVANCED){ E.set("aMaxConnections",_57[0]); E.set("aMaxConnectionsPerIP",_57[1]); E.set("aMaxConnectionsPerSubnet",_57[2]); E.set("aBacklog",_57[3]); E.set("aBufferSize",_57[4]); E.set("aQueueSize",_57[5]); $("aTestMode").selectedIndex=(_57[6]=="true")?1:0; }else{ if(cID==CCMP.CHANNEL_LIST){ UI.hasRoomsBlock=true; var _5c=_57[1]; if(_57[0]){ var _59=""; var _5d=_57[0].split(rcMTP.GS); for(var i=0;i<_5d.length;i++){ if(_5d[i].length>0){ var _5e=_5d[i].split(rcMTP.RS); if(_5e[0]==_57[1]){ _59+="<option selected value='"+_5e[0]+"'>"+_5e[0]+": "+_5e[1]+"</option>"; }else{ _59+="<option value='"+_5e[0]+"'>"+_5e[0]+": "+_5e[1]+"</option>"; } } } E.setText("roomNavPlaceholder","<select onchange=\"Logic.selectRoom()\" id=\"roomNav\" style=\"width: 400px; vertical-align:middle;\">"+_59+"</select>"); E.setText("roomSelectPlaceholder","<select onchange=\"Logic.updateClientURL()\" id=\"cgr\">"+_59+"</select>"); } Logic.updateClientURL(); }else{ if(cID==CCMP.SERVER_LOGGING){ E.check("vsLogServiceMessages",_57[0]); E.check("vsLogPublicMessages",_57[1]); E.check("vsLogPrivateMessages",_57[2]); E.check("vsLogUserRooms",_57[3]); E.check("vsLogFormatXML",_57[4]); var i=_57[5]; var l="0"; if(i=="-1"){ l="1"; } if(i=="10"){ l="2"; } if(i=="50"){ l="3"; } $("logFileLimit").selectedIndex=l; }else{ if(cID==CCMP.USER_PERMISSIONS){ E.check("vsSharedPasswords",_57[0]); E.set("vsAdminPasswords",_57[1]); E.set("vsOpPasswords",_57[2]); E.check("vsPredefinedList",_57[3]); E.set("vsAdminNames",_57[4]); E.set("vsOpNames",_57[5]); UI.setVisible("vsSPT",_57[0]=="true"); UI.setVisible("vsPLT",_57[3]=="true"); }else{ if(cID==CCMP.USER_BEHAVIOUR){ E.check("vsFloodCheck",_57[0]); E.set("vsDefaultBanTimeout",_57[1]); E.check("vsInactivityCheck",_57[2]); E.set("vsInactivityTimeout",_57[3]); E.check("vsProfanityFilter",_57[4]); E.set("vsProfaneWords",_57[5]); UI.setVisible("vsPFT",_57[4]=="true"); UI.setVisible("vsPWK",_57[4]=="true"); E.set("maxML",_57[6]); E.check("vsProfanityKick",_57[7]); E.set("vsPWLimit",_57[8]); E.set("vsKickURL",_57[9]); }else{ if(cID==CCMP.CHANNEL_GENERAL){ E.set("roomName",_57[0]); E.set("roomTopic",_57[1]); E.set("roomPassword",_57[2]); $("roomVisibility").selectedIndex=(_57[3]=="true")?1:0; }else{ if(cID==CCMP.PROFILE_LIST){ UI.hasProfileBlock=true; Logic.selectedProfile=_57[1]; if(_57[0]){ var _59=""; var _5d=_57[0].split(rcMTP.GS); for(var i=0;i<_5d.length;i++){ if(_5d[i].length>0){ var _5e=_5d[i].split(rcMTP.RS); if(_5e[0]==_57[1]){ _59+="<option selected value='"+_5e[0]+"'>"+_5e[0]+": "+_5e[1]+"</option>"; }else{ _59+="<option value='"+_5e[0]+"'>"+_5e[0]+": "+_5e[1]+"</option>"; } } } E.setText("profileNavPlaceholder","<select onchange=\"Logic.selectProfile()\" id=\"profileNav\" style=\"width: 400px; vertical-align:middle;\">"+_59+"</select>"); E.setText("profileSelectPlaceholder","<select onchange=\"Logic.updateClientURL()\" id=\"cgp\">"+_59+"</select>"); } }else{ if(cID==CCMP.PROFILE_GENERAL){ var _5e=_57[0].split(rcMTP.RS); E.set("profileName",_5e[0]); E.check("canCreateRooms",_5e[1].charAt(0)=="1"); E.check("canSwitchRooms",_5e[1].charAt(1)=="1"); E.check("canSendPrivate",_5e[1].charAt(2)=="1"); E.check("canSetURLs",_5e[1].charAt(3)=="1"); E.check("s0",_5e[2].charAt(0)=="1"); E.check("s1",_5e[2].charAt(1)=="1"); E.check("s2",_5e[2].charAt(2)=="1"); E.check("s3",_5e[2].charAt(3)=="1"); E.check("s4",_5e[2].charAt(4)=="1"); E.check("s5",_5e[2].charAt(5)=="1"); E.check("s6",_5e[2].charAt(6)=="1"); E.check("s7",_5e[2].charAt(7)=="1"); E.check("s8",_5e[2].charAt(8)=="1"); E.check("s9",_5e[2].charAt(9)=="1"); E.check("s10",_5e[2].charAt(10)=="1"); E.check("u0",_5e[3].charAt(0)=="1"); E.check("u1",_5e[3].charAt(1)=="1"); E.check("u2",_5e[3].charAt(2)=="1"); E.check("u3",_5e[3].charAt(3)=="1"); E.check("u4",_5e[3].charAt(4)=="1"); E.check("u5",_5e[3].charAt(5)=="1"); E.check("u6",_5e[3].charAt(6)=="1"); E.check("u7",_5e[3].charAt(7)=="1"); E.check("u8",_5e[3].charAt(8)=="1"); E.check("u9",_5e[3].charAt(9)=="1"); E.check("u10",_5e[3].charAt(10)=="1"); E.check("u11",_5e[3].charAt(11)=="1"); E.check("u12",_5e[3].charAt(12)=="1"); E.check("u13",_5e[3].charAt(13)=="1"); E.check("u14",_5e[3].charAt(14)=="1"); E.check("u15",_5e[3].charAt(15)=="1"); E.check("u16",_5e[3].charAt(16)=="1"); E.check("u17",_5e[3].charAt(17)=="1"); E.check("u18",_5e[3].charAt(18)=="1"); E.check("u19",_5e[3].charAt(19)=="1"); Logic.updateClientURL(); }else{ if(cID==CCMP.LANGUAGE_LIST){ if(_57[0]){ var _59=""; var _5d=_57[0].split(rcMTP.GS); for(var i=0;i<_5d.length;i++){ if(_5d[i].length>0){ _59+="<option "+(_5d[i]=="en"?"selected ":"")+"value='"+i+"'>"+_5d[i]+"</option>"; } } E.setText("languageSelectPlaceholder","<select onchange=\"Logic.updateClientURL()\" id=\"cgl\">"+_59+"</select>"); } }else{ if(cID==CCMP.THEME_LIST){ UI.hasThemeBlock=true; Logic.selectedTheme=_57[1]; if(_57[0]){ var _59=""; var _5d=_57[0].split(rcMTP.GS); for(var i=0;i<_5d.length;i++){ if(_5d[i].length>0){ var _5e=_5d[i].split(rcMTP.RS); if(_5e[0]==_57[1]){ _59+="<option selected value='"+_5e[0]+"'>"+_5e[0]+": "+_5e[1]+"</option>"; }else{ _59+="<option value='"+_5e[0]+"'>"+_5e[0]+": "+_5e[1]+"</option>"; } } } E.setText("themeNavPlaceholder","<select onchange=\"Logic.selectTheme()\" id=\"themeNav\" style=\"width: 400px; vertical-align:middle;\">"+_59+"</select>"); E.setText("themeSelectPlaceholder","<select onchange=\"Logic.updateClientURL()\" id=\"cgt\">"+_59+"</select>"); } }else{ if(cID==CCMP.THEME_GENERAL){ var _5e=_57[0].split(rcMTP.RS); E.set("themeName",_5e[0]); TE.load(_5e[1]); Logic.updateClientURL(); } } } } } } } } } } } } } } } } } } } }else{ if(_55==CCMP.STATISTICS){ if(cID==CCMP.SNAPSHOT){ E.setText("sTime",_57[0]); E.setText("sConnections",_57[1]); E.setText("sPacketsIn",_57[3]); Chart.updateCharts(_57[1],_57[2],_57[3],_57[4]); } if(cID==CCMP.HISTORY){ Chart.updateHistoryChart(_57[0],_57[1],_57[2],_57[3]); } if(cID==CCMP.B_GROUP_LIST){ var _60=""; var _61=_57[0].split(rcMTP.GS); for(var i=0;i<_61.length;i++){ if(_61[i].length>0){ var _5e=_61[i].split(rcMTP.RS); _60+=UI.formatServer(_5e[0],_5e[1],_5e[2],_5e[3]); } } E.setText("browser",_60); UI.hide("bLoading"); } if(cID==CCMP.B_CHANNEL_LIST){ var _60=""; var _61=_57[0].split(rcMTP.GS); for(var i=0;i<_61.length;i++){ if(_61[i].length>0){ var _5e=_61[i].split(rcMTP.RS); _60+=UI.formatRoom(_5e[0],_5e[1],_5e[2],_5e[3],_5e[4],_5e[5],_5e[6]); } } E.setText("browser",_60); UI.hide("bLoading"); } if(cID==CCMP.B_CHANNEL_DETAILS){ var _62=""; var _5e=_57[0].split(rcMTP.RS); var _63=""; var _64=_57[1].split(rcMTP.GS); for(var i=0;i<_64.length;i++){ if(_64[i].length>0){ var _65=_64[i].split(rcMTP.RS); _63+=UI.formatUser(_65[0],_65[1],_65[2],_65[3],_65[4],_65[5],_65[6],_65[7]); } } _62+=UI.formatRoom(_5e[0],_5e[1],_5e[2],"",_5e[3],_5e[4],_5e[5]); _62+=_63; E.setText("browser",_62); UI.hide("bLoading"); } if(cID==CCMP.BAN_LIST){ var _66="<table class=\"banList\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\"><thead><tr><th>&nbsp;</th><th>IP&nbsp;address</th><th>Nickname</th><th>Expires</th><th>Ban&nbsp;Reason</th></tr></thead>"; var _67=_57[0].split(rcMTP.GS); for(var i=0;i<_67.length;i++){ if(_67[i].length>0){ var _5e=_67[i].split(rcMTP.RS); _66+=UI.formatBan(_5e[0],_5e[1],_5e[2],_5e[3],_5e[4],i); } } if(_67.length==1){ _66+="<tr><td colspan=\"5\">No active bans.</td></tr>"; } _66+="</table>"; E.setText("banlist",_66); UI.hide("bLoading"); } } } } } },login:function(){ UI.showStatus("Logging in..."); var _68=$("rcLoginRemember").checked; Logic.userName=E.get("rcUserName"); Logic.password=E.get("rcPassword"); if(_68){ rcCookie.set("u",Logic.userName,365); rcCookie.set("p",Logic.password,365); rcCookie.set("r",_68,365); }else{ rcCookie.del("u"); rcCookie.del("p"); rcCookie.del("r"); } rcFC.connect(Logic.host,Logic.port); },logout:function(){ clearTimeout(Logic.pingTimeoutTask); clearTimeout(Logic.autoUpdateTask); rcFC.send(CCMP.AUTHENTICATION,CCMP.C_LOGOUT); },updateAccessControl:function(){ if(E.get("rcAdminPassword1")!=E.get("rcAdminPassword2")){ UI.showWarning("Error","Passwords don't match!"); }else{ UI.showStatus("Updating access control settings ..."); rcFC.send(CCMP.SETTINGS,CCMP.ACCESS_CONTROL,E.get("rcAdminPassword1"),E.get("rcTrustedIPs").replace(/[\s\n\t]+/g,",")); } },probeBindOptions:function(){ UI.showStatus("Probing bind options ..."); rcFC.send(CCMP.SETTINGS,CCMP.PROBE_BIND_OPTIONS); },updateBindSettings:function(){ var _69=E.get("rcBindAddressOptions"); var _6a=E.get("ccBindAddressOptions"); if(_6a!="-"){ Logic.url="http://"+_6a+"/"; } if(_69!="-"||_6a!="-"){ Logic.restartExpected=true; UI.showStatus("Updating network settings ..."); rcFC.send(CCMP.SETTINGS,CCMP.BIND_SETTINGS,_69,_6a); } },uploadReginfo:function(){ UI.hide("rcRegCodeForm"); UI.show("rcRegLink"); rcFC.send(CCMP.SETTINGS,CCMP.REGINFO,E.get("rcRegKeyBlock").replace(/[\s\n\t]+/g,""),E.get("rcRegDomain")); E.set("rcRegKeyBlock",""); },requestUpdateCheck:function(){ UI.showStatus("Checking for updates, please wait ..."); rcFC.send(CCMP.SETTINGS,CCMP.SOFTWARE_UPDATE); },requestRestart:function(){ Logic.restartExpected=true; rcFC.send(CCMP.SETTINGS,CCMP.REQUEST_RESTART); },applyUpdate:function(){ Logic.applyingUpdate=true; rcFC.send(CCMP.SETTINGS,CCMP.REQUEST_RESTART); },updateAdvancedSettings:function(){ Logic.restartExpected=true; UI.showStatus("Updating ..."); rcFC.send(CCMP.SETTINGS,CCMP.SERVER_ADVANCED,E.get("aMaxConnections"),E.get("aMaxConnectionsPerIP"),E.get("aMaxConnectionsPerSubnet"),E.get("aBacklog"),E.get("aBufferSize"),E.get("aQueueSize"),$("aTestMode").selectedIndex==1); },selectVS:function(){ UI.showStatus("Loading data ..."); rcFC.send(CCMP.SETTINGS,CCMP.VSERVER_SELECT,E.get("vsNav")); $("cgs").selectedIndex=E.get("vsNav"); },addVS:function(){ UI.showStatus("Adding virtual server ..."); rcFC.send(CCMP.SETTINGS,CCMP.VSERVER_ADD); UI.doSelect("n2-1"); },removeVS:function(){ var ok=confirm("Remove selected server?"); if(ok){ UI.showStatus("Removing virtual server ..."); rcFC.send(CCMP.SETTINGS,CCMP.VSERVER_REMOVE,E.get("vsNav")); } },selectRoom:function(){ UI.showStatus("Loading data ..."); rcFC.send(CCMP.SETTINGS,CCMP.CHANNEL_SELECT,E.get("roomNav")); },addRoom:function(){ UI.showStatus("Adding room ..."); rcFC.send(CCMP.SETTINGS,CCMP.CHANNEL_ADD); },removeRoom:function(){ var ok=confirm("Remove selected room?"); if(ok){ UI.showStatus("Removing room ..."); rcFC.send(CCMP.SETTINGS,CCMP.CHANNEL_REMOVE,E.get("roomNav")); } },selectProfile:function(){ UI.showStatus("Loading data ..."); rcFC.send(CCMP.SETTINGS,CCMP.PROFILE_SELECT,E.get("profileNav")); },selectTheme:function(){ UI.showStatus("Loading data ..."); rcFC.send(CCMP.SETTINGS,CCMP.THEME_SELECT,E.get("themeNav")); },updateGeneralSettings:function(){ UI.showStatus("Updating ..."); rcFC.send(CCMP.SETTINGS,CCMP.SERVER_GENERAL,E.get("vsDescription"),E.get("vsNotes"),E.get("vsUserLimit"),E.get("vsRoomLimit"),E.get("vsUsersPerRoom"),$("vsStatus").selectedIndex==1,E.get("vsCloseMessage"),($("vsUseHMAC").selectedIndex==1)?E.get("vsHMAC"):"",$("vsDoubleLogin").selectedIndex,E.get("vsWelcomeMessage"),E.get("OEMName")); },updateLoggingSettings:function(){ UI.showStatus("Updating log settings ..."); var i=$("logFileLimit").selectedIndex; var l="0"; if(i==1){ l="-1"; } if(i==2){ l="10"; } if(i==3){ l="50"; } Logic.restartExpected=true; rcFC.send(CCMP.SETTINGS,CCMP.SERVER_LOGGING,$("vsLogServiceMessages").checked,$("vsLogPublicMessages").checked,$("vsLogPrivateMessages").checked,$("vsLogUserRooms").checked,$("vsLogFormatXML").checked,l); },updateUserSettings:function(){ UI.showStatus("Updating user behavior settings ..."); rcFC.send(CCMP.SETTINGS,CCMP.USER_BEHAVIOUR,$("vsFloodCheck").checked,E.get("vsDefaultBanTimeout"),$("vsInactivityCheck").checked,E.get("vsInactivityTimeout"),$("vsProfanityFilter").checked,Logic.toCSF(E.get("vsProfaneWords")),E.get("maxML"),$("vsProfanityKick").checked,E.get("vsPWLimit"),E.get("vsKickURL")); },updateUserPermissions:function(){ UI.showStatus("Updating user permission settings ..."); rcFC.send(CCMP.SETTINGS,CCMP.USER_PERMISSIONS,$("vsSharedPasswords").checked,Logic.toCSF(E.get("vsAdminPasswords")),Logic.toCSF(E.get("vsOpPasswords")),$("vsPredefinedList").checked,Logic.toCSF(E.get("vsAdminNames")),Logic.toCSF(E.get("vsOpNames"))); },toCSF:function(src){ return src.replace(/,/g,", ").replace(/[\s\n\t]+/g," "); },updateRoomSettings:function(){ UI.showStatus("Updating room settings ..."); rcFC.send(CCMP.SETTINGS,CCMP.CHANNEL_GENERAL,E.get("roomName"),E.get("roomTopic"),E.get("roomPassword"),$("roomVisibility").selectedIndex==1); },updateProfileSettings:function(){ UI.showStatus("Updating room settings ..."); var t=Logic.ch1; rcFC.send(CCMP.SETTINGS,CCMP.PROFILE_GENERAL,E.get("profileName"),t("canCreateRooms")+t("canSwitchRooms")+t("canSendPrivate")+t("canSetURLs"),t("s0")+t("s1")+t("s2")+t("s3")+t("s4")+t("s5")+t("s6")+t("s7")+t("s8")+t("s9")+t("s10"),t("u0")+t("u1")+t("u2")+t("u3")+t("u4")+t("u5")+t("u6")+t("u7")+t("u8")+t("u9")+t("u10")+t("u11")+t("u12")+t("u13")+t("u14")+t("u15")+t("u16")+t("u17")+t("u18")+t("u19")); },ch1:function(arg){ return $(arg).checked?"1":"0"; },previewProfileSettings:function(){ Logic.updateProfileSettings(); window.open($("rcCurrentLinkHref").href+"?0,0,0,0,"+E.get("profileNav")+"&nn=ProfileTester"); },saveTheme:function(){ UI.showStatus("Saving theme ..."); var t=Logic.ch1; rcFC.send(CCMP.SETTINGS,CCMP.THEME_GENERAL,E.get("themeName"),TE.colors); },updateClientURL:function(){ var l=$("rcCurrentLinkHref").href+"?"+E.get("cgs")+","+E.get("cgr")+","+E.get("cgt")+","+E.get("cgl")+","+E.get("cgp"); E.setText("cURL",l); $("cURLhref").href=l; },vsUpdateClientURL:function(){ UI.showStatus("Loading data ..."); rcFC.send(CCMP.SETTINGS,CCMP.VSERVER_SELECT,E.get("cgs")); $("vsNav").selectedIndex=E.get("cgs"); },autoUpdateTask:null,autoUpdatingStats:false,requestUpdateStats:function(){ clearTimeout(Logic.autoUpdateTask); var ar=15000; if(Logic.autoUpdatingStats){ UI.show("sChartLoading"); rcFC.send(CCMP.STATISTICS,CCMP.HISTORY,$("sChartRange").selectedIndex); if($("sChartRange").selectedIndex==1){ ar=60000; } if($("sChartRange").selectedIndex==2){ ar=300000; } if($("sChartRange").selectedIndex>2){ ar=3000000; } } Logic.autoUpdateTask=setTimeout("Logic.requestUpdateStats()",ar); },requestResetStats:function(){ rcFC.send(CCMP.STATISTICS,CCMP.RESET); },browse_home:function(){ UI.show("bLoading"); rcFC.send(CCMP.STATISTICS,CCMP.B_HOME); },browse_server:function(ID){ UI.show("bLoading"); rcFC.send(CCMP.STATISTICS,CCMP.B_CHANNEL_LIST,ID); },browse_room:function(ID){ UI.show("bLoading"); rcFC.send(CCMP.STATISTICS,CCMP.B_CHANNEL_DETAILS,ID); },browse_user:function(ID){ UI.show("bLoading"); rcFC.send(CCMP.STATISTICS,CCMP.B_USER_DETAILS,ID); },listBans:function(){ rcFC.send(CCMP.STATISTICS,CCMP.BAN_LIST); },liftBan:function(id){ rcFC.send(CCMP.STATISTICS,CCMP.BAN_LIFT,id); },liftAllBans:function(){ rcFC.send(CCMP.STATISTICS,CCMP.BAN_LIFT); }}; var TE={current:"c0",colorDefs:new Array("Desktop background","Panel/Button/Tab background","Panel/Button/Tab foreground (Labels)","Inactive Tab/Toggled Button background","Panel/Button/Tab border","Window titlebar background","Window titlebar foreground","Background of a shaded item","Background of a highlighted (hovered) item","Separator line","Avatar border color","Timestamp","Link","Chat area background","Server message, body","Server message, highlighted item","User message, body (default color)","User message, user name","User message, own name","Private message (tells you)","Own name","Online user (also used as room name)","Away user (also used as room topic)","Ignored user","Administrator","Operator","Room operator"),formatColor:function(id,_7a,_7b){ return "<span onclick=\"TE.editColor('c"+id+"');\" id=\"c"+id+"\" title=\""+_7a+"\" style=\"background: "+_7b+";"+((id>26)?"width:16px;":"")+"\">&nbsp;&nbsp;&nbsp;</span>"; },formatColors:function(){ var c=TE.colors; var res="<table class=\"cBlock\" cellspacing=\"25\" cellpadding=\"5\" width=\"490\" border=\"0\"><tr><td>"; for(var i=0;i<47;i++){ if(i==0){ res+="Windows, panels, buttons:<br/>"; } if(i==7){ res+="</td><td>Messages, lists:<br/>"; } if(i==13){ res+="</td></tr><tr><td>Chat area, messages:<br/>"; } if(i==20){ res+="</td><td>User list, nicknames:<br/>"; } if(i==27){ res+="</td></tr><tr><td>Custom colors palette:<br/>"; } if(i==37){ res+="<br/>"; } res+=TE.formatColor(i,i+": "+(TE.colorDefs[i]?TE.colorDefs[i]+" ("+c[i]+")":"("+c[i]+")"),c[i]); } res+="</td><td valign=\"top\">3D effect:<br/>"; res+="<select id=\"d3e\" onchange=\"TE.pre();\"><option value=\"0\">None</option><option "+(c[47]=="1"?"selected ":"")+"value=\"1\">Plastic</option></select>"; res+="</td></tr><tr><td colspan=\"2\">Selected: <b id=\"nowEditing\"></b></td></tr></table>"; return res; },editColor:function(id){ TE.current=id; var i=id.substr(1); E.setText("nowEditing",TE.colorDefs[i]?TE.colorDefs[i]:TE.colors[i]); TE.cp.updateH(TE.colors[id.substr(1)].substr(1)); },load:function(str){ TE.originals=str; TE.colors=TE.originals.split(","); E.setText("themeEditor",TE.formatColors()); TE.cp.location=Logic.url+"cp/cp.html"; TE.pre(); },reset:function(){ TE.colors=TE.originals.split(","); E.setText("themeEditor",TE.formatColors()); TE.pre(); },setColor:function(c){ $(TE.current).style.background="#"+c; TE.colors[TE.current.substr(1)]="#"+c; TE.pre(); },exp:function(){ E.set("rawsrc",TE.colors); },imp:function(){ var src=E.get("rawsrc"); var c=src.split(","); if(c.length==48){ TE.colors=c; E.setText("themeEditor",TE.formatColors()); TE.pre(); } E.set("rawsrc",""); },pre:function(){ TE.colors[47]=$("d3e").selectedIndex; TE.cc.location=$("rcCurrentLinkHref").href+"?pre="+escape(TE.colors); E.set("rawsrc",""); },bind:function(){ TE.cc=window.frames["chatclient"]; TE.cp=window.frames["colorpicker"]; }}; var UI={catCount:5,itemCount:10,hasVsBlock:false,hasRoomsBlock:false,hasProfileBlock:false,hasThemeBlock:false,doSelect:function(id){ for(var i=1;i<this.catCount;i++){ UI.hide("n"+i); } for(var i=0;i<this.catCount;i++){ for(var j=0;j<this.itemCount;j++){ var nav=$("n"+i+"-"+j); if(nav){ nav.className="navItem"; } var sub=$("sn"+i+"-"+j); if(sub){ UI.hide(sub); } } } if(!id){ UI.hideCharts(); return; } var el=$(id); var _8b=el.id.substring(0,el.id.indexOf("-")); UI.show(_8b); if(el){ el.className="navItemSelected"; if(this.hasVsBlock){ if(_8b=="n2"){ UI.show("vsNavBlock"); }else{ UI.hide("vsNavBlock"); } } Logic.autoUpdatingStats=(el.id=="n4-1"); if(el.id=="n4-1"){ UI.showCharts(); Logic.requestUpdateStats(); }else{ UI.hideCharts(); } Logic.ping(); if(el.id=="n4-2"){ Logic.browse_home(); } if(el.id=="n4-3"){ Logic.listBans(); } if(this.hasRoomsBlock){ if(el.id=="n2-2"){ UI.show("roomNavBlock"); }else{ UI.hide("roomNavBlock"); } } if(this.hasProfileBlock){ if(el.id=="n3-2"){ UI.show("profileNavBlock"); }else{ UI.hide("profileNavBlock"); } } if(this.hasProfileBlock){ if(el.id=="n3-3"){ UI.show("themeNavBlock"); TE.bind(); Logic.selectTheme(); }else{ UI.hide("themeNavBlock"); } } var sub=$("s"+el.id); if(sub){ UI.show(sub); } } },showCharts:function(){ $("connectionChart").style.left="220px"; $("packetChart").style.left="600px"; if(Chart.historyChartCreated){ $("historyChart").style.left="220px"; } },hideCharts:function(){ $("connectionChart").style.left="-1000px"; $("packetChart").style.left="-1000px"; $("historyChart").style.left="-1000px"; },goHome:function(){ this.doSelect("n1-1"); },setGDS:function(){ if(rcCookie.get("gds")){ rcCookie.del("gds"); }else{ rcCookie.set("gds","1",365); } },showWarning:function(_8c,_8d){ rcDialog.show(_8c,"<b>"+_8d+"</b>","#FF3300",true); },showInfo:function(_8e,_8f){ rcDialog.show(_8e,_8f,"#6495ED",true); },showStatus:function(_90){ rcDialog.show(null,"<img src='loading.gif' style='vertical-align:bottom'/> <b>"+_90+"</b>","#999",true); },hideStatus:function(){ rcDialog.hide(); },generateHMAC:function(){ var res=""; for(var i=0;i<16;i++){ var r=Math.random()*26+65; res+=String.fromCharCode(r); } return res; },evenRoom:true,formatRoom:function(_94,_95,_96,_97,_98,_99,_9a){ var tmp="<div class=\""+((this.evenRoom)?"roomView":"roomViewShade")+"\">"; var _9c="&nbsp;"; if(_98!=""){ _9c+="Owner: <b>"+_98+"</b>&nbsp;|&nbsp;"; } if(_99!=""){ _9c+="Pass: <b>"+_99+"</b>&nbsp;|&nbsp;"; } if(_9a=="true"){ _9c+="<b>Hidden</b>&nbsp;|&nbsp;"; } tmp+="<div class=\"roomInfo\">"+_9c+"</div>"; tmp+="<div class=\"roomName\"><a href=\"javascript:Logic.browse_room("+_94+");\">"+_95+"</a></div>"; tmp+="<div class=\"roomTopic\">"+_96+"</div>"; tmp+="<div class=\"userList\">"+_97+"</div>"; tmp+="</div>"; this.evenRoom=!this.evenRoom; return tmp; },formatServer:function(_9d,_9e,_9f,_a0){ var tmp="<div class=\""+((this.evenRoom)?"roomView":"roomViewShade")+"\">"; var _a2="&nbsp;"; tmp+="<div class=\"roomInfo\">"+_a2+"</div>"; tmp+="<div class=\"roomName\"><a href=\"javascript:Logic.browse_server("+_9d+");\">"+_9e+"</a></div>"; tmp+="<div class=\"roomTopic\">"+_9f+"</div>"; tmp+="<div class=\"userList\">"+_a0+"</div>"; tmp+="</div>"; this.evenRoom=!this.evenRoom; return tmp; },userRoles:{3:"user",2:"room operator",1:"operator",0:"administrator"},formatUser:function(_a3,_a4,_a5,_a6,_a7,_a8,_a9,_aa){ var tmp="<div class=\""+((this.evenRoom)?"roomView":"roomViewShade")+"\">"; var _ac="&nbsp;"; if(_a8.indexOf("http")==0){ tmp+="<img style=\"float: left; border: 0; padding-right: 10px;\" width=\"35\" height=\"35\" src=\""+_a8+"\"/>"; } tmp+="<div class=\"roomInfo\">Host: <b>"+_a5+"</b></div>"; tmp+="<div class=\"roomName\">"+_a4+(_a7=="3"?"":" ("+UI.userRoles[_a7]+")")+"</div>"; tmp+="Online: "+_aa; tmp+="<div class=\"roomTopic\">"+_a6+"</div>"; tmp+="</div>"; this.evenRoom=!this.evenRoom; return tmp; },formatBan:function(IP,_ae,_af,_b0,_b1,i){ var tmp="<tr"+(i%2==0?"":" class=\"ev\"")+">"; tmp+="<td><input value=\"Lift\" type=\"submit\" onclick=\"Logic.liftBan('"+IP+"');\"/></td>"; tmp+="<td>"+IP+"</td><td>"+_af+"</td><td>"+_ae+"</td><td class=\"wrp\"><b>"+_b0+":&nbsp</b>"+_b1+"</td></tr>"; return tmp; },init:function(){ if(rcCookie.get("u")){ E.set("rcUserName",rcCookie.get("u")); E.set("rcPassword",rcCookie.get("p")); UI.showStatus("Logging in..."); Logic.userName=rcCookie.get("u"); Logic.password=rcCookie.get("p"); rcFC.connect(Logic.host,Logic.port); }else{ UI.show("content"); $("rcUserName").focus(); } },hide:function(id){ $(id).style.display="none"; },show:function(id){ $(id).style.display=""; },setVisible:function(id,_b7){ if(_b7){ UI.show(id); }else{ UI.hide(id); } }}; var Chart={embedCharts:function(){ document.write("<div id=\"historyChart\" style=\" position: absolute;"+"width: 740px; height: 280px;"+"top: 280px; left: -1000px; background: #eee;\">"+"<object id=\"historyChart_FC\" type=\"application/x-shockwave-flash\""+"data=\"chart_series.swf?dataXML=%3Cgraph/%3E&chartWidth=740&chartHeight=280\" width=\"740\" height=\"280\">"+"<param name=\"movie\" value=\"chart_series.swf?dataXML=%3Cgraph/%3E&chartWidth=740&chartHeight=280\"/>"+"</object></div>"); document.write("<div id=\"connectionChart\" style=\" position: absolute;"+"width: 360px;"+"top: 70px; left: -1000px;\">"+"<object id=\"connectionChart_FC\" type=\"application/x-shockwave-flash\""+"data=\"chart_angular.swf?dataXML=%3Cgraph/%3E&chartWidth=360&chartHeight=180\" width=\"360\" height=\"180\">"+"<param name=\"movie\" value=\"chart_angular.swf?dataXML=%3Cgraph/%3E&chartWidth=360&chartHeight=180\"/>"+"</object><div style=\"text-align: center; color: #FF9900; font-size: 1.3em; font-weight: bold;\">Users: <span id=\"sConnections\">-</span></div></div>"+""); UI.cc=$("connectionChart_FC"); document.write("<div id=\"packetChart\" style=\" position: absolute;"+"width: 360px;"+"top: 70px; left: -1000px;\">"+"<object id=\"packetChart_FC\" type=\"application/x-shockwave-flash\""+"data=\"chart_angular.swf?dataXML=%3Cgraph/%3E&chartWidth=360&chartHeight=180\" width=\"360\" height=\"180\">"+"<param name=\"movie\" value=\"chart_angular.swf?dataXML=%3Cgraph/%3E&chartWidth=360&chartHeight=180\"/>"+"</object><div style=\"text-align: center; color: #66EE66; font-size: 1.3em; font-weight: bold;\">Messages: <span id=\"sPacketsIn\">-</span>/s</div></div>"+""); UI.pc=$("packetChart_FC"); },currentConnectionLimit:-1,currentPacketLimit:-1,historyChartCreated:false,cc:0,pc:0,updateCharts:function(_b8,_b9,_ba,_bb){ if(+_b9>+this.currentConnectionLimit){ this.currentConnectionLimit=_b9; var _bc="<chart upperLimit='"+this.currentConnectionLimit+"' lowerLimit='0'"+"numberSuffix='' baseFontColor='646F8F' majorTMNumber='11'"+"majorTMColor='646F8F' majorTMHeight='9' minorTMNumber='5' minorTMColor='646F8F' minorTMHeight='3' pivotRadius='0' showHoverCap='1' majorTMThickness='1' showGaugeBorder='0' gaugeOuterRadius='150' gaugeInnerRadius='140' gaugeOriginX='180' gaugeOriginY='160' gaugeScaleAngle='180' gaugeAlpha='50' placeValuesInside='1' decimalPrecision='0' displayValueDistance='22' hoverCapBgColor='F2F2FF' hoverCapBorderColor='6A6FA6'>"; _bc+="<dials><dial value='"+_b8+"' bgColor='FF9900' borderAlpha='0' baseWidth='8' topWidth='3' radius='160'/></dials></chart>"; UI.cc.SetVariable("_root.dataURL",""); UI.cc.SetVariable("_root.isNewData","1"); UI.cc.SetVariable("_root.newData",_bc); UI.cc.TGotoLabel("/","JavaScriptHandler"); }else{ UI.cc.SetVariable("_root.index","1"); UI.cc.SetVariable("_root.value",_b8); UI.cc.TGotoLabel("/","NewDataHandler"); } if(+_bb>+this.currentPacketLimit){ this.currentPacketLimit=_bb; var _bc="<chart upperLimit='"+this.currentPacketLimit+"' lowerLimit='0'"+"numberSuffix='' baseFontColor='646F8F' majorTMNumber='11'"+"majorTMColor='646F8F' majorTMHeight='9' minorTMNumber='5' minorTMColor='646F8F' minorTMHeight='3' pivotRadius='0' showHoverCap='1' majorTMThickness='1' showGaugeBorder='0' gaugeOuterRadius='150' gaugeInnerRadius='140' gaugeOriginX='180' gaugeOriginY='160' gaugeScaleAngle='180' gaugeAlpha='50' placeValuesInside='1' decimalPrecision='0' displayValueDistance='22' hoverCapBgColor='F2F2FF' hoverCapBorderColor='6A6FA6'>"; _bc+="<dials><dial value='"+_ba+"' bgColor='66EE66' borderAlpha='0' baseWidth='8' topWidth='3' radius='160'/></dials></chart>"; UI.pc.SetVariable("_root.dataURL",""); UI.pc.SetVariable("_root.isNewData","1"); UI.pc.SetVariable("_root.newData",_bc); UI.pc.TGotoLabel("/","JavaScriptHandler"); }else{ UI.pc.SetVariable("_root.index","1"); UI.pc.SetVariable("_root.value",_ba); UI.pc.TGotoLabel("/","NewDataHandler"); } UI.cc.rewind(); UI.pc.rewind(); },updateHistoryChart:function(_bd,_be,_bf,_c0){ var _c1=+0; var _c2=_be.split(","); var _c3=_c2.length; var _c4=_bf.split(","); var _c5=_c0.split(","); for(var i=0;i<_c3;i++){ if(+_c2[i]>_c1){ _c1=_c2[i]; } if(+_c4[i]>_c1){ _c1=_c4[i]; } if(+_c5[i]>_c1){ _c1=_c5[i]; } } var XML="<graph showLegend='1' decimalPrecision='2' formatNumberScale='1' showvalues='0' animation='0' numDivLines='3' numVdivlines='"+(_bd-1)+"' decimalPrecision='0'  anchorAlpha='0' canvasBorderThickness='1'>"; XML+="<categories>"; for(var i=0;i<_c3;i++){ XML+="<category/>"; } XML+="</categories>"; XML+="<dataset yAxisMaxValue='"+_c1+"' seriesname='Users' color='FF9900' showValues='0' lineThickness='1' tickMarkDecimalPrecision='0' decimalPrecision='2'>"; for(var i=0;i<_c3;i++){ XML+="<set value='"+_c2[i]+"'/>"; } XML+="</dataset>"; XML+="<dataset yAxisMaxValue='"+_c1+"' showAxis='0' seriesname='Incoming Messages' color='66EE66' showValues='0' lineThickness='1' tickMarkDecimalPrecision='0' decimalPrecision='2'>"; for(var i=0;i<_c3;i++){ XML+="<set value='"+_c4[i]+"'/>"; } XML+="</dataset>"; XML+="<dataset yAxisMaxValue='"+_c1+"' seriesname='Dropped Messages' color='666666' showValues='0' lineThickness='1' tickMarkDecimalPrecision='0' decimalPrecision='2'>"; for(var i=0;i<_c3;i++){ XML+="<set value='"+_c5[i]+"'/>"; } XML+="</dataset>"; XML+="</graph>"; var cc=$("historyChart_FC"); cc.SetVariable("_root.dataURL",""); cc.SetVariable("_root.isNewData","1"); cc.SetVariable("_root.newData",XML); cc.TGotoLabel("/","JavaScriptHandler"); if(!Chart.historyChartCreated){ Chart.historyChartCreated=true; UI.showCharts(); } UI.hide("sChartLoading"); }}; var rcDialog={initialized:false,showing:false,init:function(){ document.body.appendChild(document.createElement("div")).innerHTML="<div id=\"grayBox\" style=\"display: none; position: absolute; width: 2000px; height: 2000px;"+"margin: 0; padding: 0; top: 0; left: 0; background: #000; opacity: 0.3; filter: alpha( opacity = 30 ); -moz-opacity: 0.3;\"/>"; document.body.appendChild(document.createElement("div")).innerHTML="<div id=\"dialogBox\" style=\"display: none; z-index: 2000; top: 150px; left: 320px;"+"position: absolute; text-align: center;"+"background: #FFFFFF; color: #000000; border: 2px solid;\">"+"<div id=\"dialogTitle\" style=\"display: none; color: #FFFFFF; font-weight: bold; padding: 5px;\"></div>"+"<div id=\"dialogBody\" style=\"padding: 12px;\"></div>"+"<input id=\"dialogOKButton\" style=\"display: none;  margin-bottom: 10px;\" type=\"submit\" value=\"Close\" onclick=\"rcDialog.hide()\"/>"+"</div>"; this.initialized=true; },show:function(_c9,_ca,_cb,_cc){ if(!this.initialized){ this.init(); } if(this.showing){ this.hide(); } this.showing=true; if(_cc){ UI.show("grayBox"); } UI.show("dialogBox"); if(_c9){ E.setText("dialogTitle",_c9); UI.show("dialogTitle"); UI.show("dialogOKButton"); $("dialogOKButton").focus(); } if(_cb){ $("dialogBox").style.borderColor=_cb; $("dialogTitle").style.background=_cb; } E.setText("dialogBody",_ca); },hide:function(){ UI.hide("grayBox"); UI.hide("dialogBox"); UI.hide("dialogTitle"); UI.hide("dialogOKButton"); }}; if(rcBR.W3CDOMSupported){ UI.showStatus("Loading..."); rcFC.createObject(rcInit); Chart.embedCharts(); }else{ die("<b>This application requires a web browser with good W3C DOM support.</b><br/>"+"Please upgrade your browser: IE6+, Firefox, Opera, Safari"); } function rcInit(_cd){ if(_cd){ Logic.init(); UI.init(); UI.hideStatus(); }else{ die("<b>This application requires Flash.</b><br/>"+"Please install the latest Flash Player from Adobe: <a href=\"http://www.adobe.com/go/getflashplayer/\">Download</a>"); } } function die(why){ document.open(); document.write(why); document.close(); }  